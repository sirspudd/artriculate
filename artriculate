#!/usr/bin/env bash

executed_file=$(readlink -f ${BASH_SOURCE[0]})
script_dir=$(dirname ${executed_file})

force_wayland=true

cmd=${script_dir}/artriculate-bin

args="$@"
env=""

if $force_wayland && [[ "$XDG_SESSION_TYPE" = "wayland" ]]; then
  args="$args -platform wayland"
fi

env="$env __GL_SYNC_TO_VBLANK=1 QML_FORCE_THREADED_RENDERER=1"

export $env
echo "Running in env"
env
echo "Running cmd: $cmd with args: $args"
$cmd $args
